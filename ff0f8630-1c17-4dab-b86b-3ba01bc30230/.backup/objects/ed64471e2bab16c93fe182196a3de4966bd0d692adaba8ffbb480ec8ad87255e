# LuCI App Network Scripts v3.0 Pro

> "èƒ½è·‘å°±è¡Œ"æ˜¯æ‡¦å¤«çš„å€Ÿå£ï¼Œæˆ‘ä»¬è¦çš„æ˜¯**æè‡´**ã€‚

## ç®€ä»‹
è¿™æ˜¯ä¸€ä¸ªä¸º OpenWrt è®¾è®¡çš„é«˜çº§ç½‘ç»œåˆ‡æ¢ä¸è®¤è¯ç®¡ç†æ’ä»¶ã€‚å®ƒæŠ›å¼ƒäº†ä¼ ç»Ÿçš„ Crontab è½®è¯¢æœºåˆ¶ï¼Œé‡‡ç”¨ **Procd å®ˆæŠ¤è¿›ç¨‹** + **JSON çŠ¶æ€ç¼“å­˜** æ¶æ„ï¼Œå®ç°äº†æ¯«ç§’çº§çš„ Web ç•Œé¢å“åº”å’Œç§’çº§çš„ç½‘ç»œæ•…éšœåˆ‡æ¢ã€‚

## æ ¸å¿ƒç‰¹æ€§
- **âš¡ å®ˆæŠ¤è¿›ç¨‹åŒ–**: æ ¸å¿ƒé€»è¾‘ç”± `network_switch.sh` å®ˆæŠ¤è¿›ç¨‹æ¥ç®¡ï¼Œè½®è¯¢é—´éš”å¯ä½è‡³ 1 ç§’ï¼ˆé»˜è®¤ 10 ç§’ï¼‰ã€‚
- **ğŸš€ é›¶é˜»å¡ Web**: Web ç•Œé¢é€šè¿‡ AJAX è½®è¯¢ `/tmp/network_scripts_state.json`ï¼Œä¸å†å› åå° Ping æ“ä½œè€Œå¡é¡¿ã€‚
- **ğŸ§  æ™ºèƒ½ç­–ç•¥**: æ”¯æŒåŸºäºæ—¶é—´æ®µçš„ç­–ç•¥è·¯ç”±ï¼ˆå®½å¸¦/CPEï¼‰ä»¥åŠåŸºäºè´¨é‡ï¼ˆå»¶è¿Ÿ/ä¸¢åŒ…ï¼‰çš„è‡ªåŠ¨æ•…éšœè½¬ç§»ã€‚
- **ğŸ”’ é”å®šæ¨¡å¼**: ä¸€é”®é”å®šç‰¹å®šçº¿è·¯ï¼Œç»´æŠ¤æˆ–æµ‹è¯•æ—¶ä¸å†è¢«è‡ªåŠ¨åˆ‡æ¢æ‰“æ‰°ã€‚
- **ğŸ“Š å®æ—¶è´¨é‡ç›‘æµ‹**: å®æ—¶æ˜¾ç¤ºå®½å¸¦ä¸ CPE çš„å»¶è¿Ÿã€ä¸¢åŒ…ç‡åŠè´¨é‡è¯„åˆ†ã€‚

## ç›®å½•ç»“æ„
```text
luci-app-network-scripts/
â”œâ”€â”€ Makefile                # OpenWrt ç¼–è¯‘æè¿°æ–‡ä»¶
â”œâ”€â”€ root/
â”‚   â”œâ”€â”€ etc/
â”‚   â”‚   â”œâ”€â”€ config/         # é»˜è®¤é…ç½®æ–‡ä»¶
â”‚   â”‚   â””â”€â”€ init.d/         # Procd å¯åŠ¨è„šæœ¬
â”‚   â””â”€â”€ usr/
â”‚       â”œâ”€â”€ bin/            # å®ˆæŠ¤è¿›ç¨‹è„šæœ¬
â”‚       â””â”€â”€ lib/
â”‚           â””â”€â”€ network_scripts/ # æ ¸å¿ƒé€»è¾‘åº“ (common, quality, auth)
â””â”€â”€ luasrc/
    â”œâ”€â”€ controller/         # LuCI API æ¥å£
    â”œâ”€â”€ model/cbi/          # é…ç½®é¡µé¢å®šä¹‰
    â””â”€â”€ view/               # çŠ¶æ€ç›‘æ§é¢æ¿ (AJAX)
```

## ç¼–è¯‘å®‰è£…
1. å°†æœ¬ç›®å½•æ”¾ç½®äº OpenWrt SDK çš„ `package/` ç›®å½•ä¸‹ã€‚
2. è¿è¡Œ `make menuconfig` å¹¶é€‰æ‹© `LuCI -> Applications -> luci-app-network-scripts`ã€‚
3. è¿è¡Œ `make package/luci-app-network-scripts/compile V=s`ã€‚

## è°ƒè¯•å‘½ä»¤
- **æŸ¥çœ‹çŠ¶æ€**: `cat /tmp/network_scripts_state.json`
- **æ‰‹åŠ¨æµ‹è¯•**: `/usr/bin/network_switch.sh test`
- **æŸ¥çœ‹æ—¥å¿—**: `logread -e network_scripts` æˆ– `tail -f /var/log/network_scripts/network_switch.log`

---
*Generated by Antigravity (Cyber Elf)*
